# --------------------------------------------------------------------------------------------
# ğŸ“„ Dockerfile â€” VersiÃ³n SEGURA, aplicando buenas prÃ¡cticas para imÃ¡genes de contenedores.
# --------------------------------------------------------------------------------------------

# âœ… BUENA PRÃCTICA:
# Usar imagen base con versiÃ³n especÃ­fica en lugar de una etiqueta genÃ©rica 'latest'.
# Esto asegura reproducibilidad y evita que actualizaciones inesperadas rompan el build.
FROM mcr.microsoft.com/dotnet/aspnet:8.0

# --------------------------------------------------------------------------------------------
# ğŸ“Œ Definir el directorio de trabajo dentro del contenedor.
# Todo el contenido de la aplicaciÃ³n se copiarÃ¡ en esta ruta.
WORKDIR /app

# --------------------------------------------------------------------------------------------
# ğŸ“Œ Copiar todos los archivos del contexto de compilaciÃ³n al contenedor.
# Nota: Es recomendable usar un archivo `.dockerignore` para excluir archivos innecesarios.
COPY . .

# --------------------------------------------------------------------------------------------
# âœ… BUENA PRÃCTICA:
# Crear un usuario no root dentro de la imagen y asignarle permisos sobre la carpeta de trabajo.
# Esto reduce el impacto de posibles vulnerabilidades al limitar los privilegios de ejecuciÃ³n.
RUN adduser --disabled-password --gecos '' appuser && \
    chown -R appuser /app

# ğŸ“Œ Cambiar el contexto de ejecuciÃ³n al usuario no root reciÃ©n creado.
USER appuser

# --------------------------------------------------------------------------------------------
# ğŸ“Œ Definir el comando de entrada para ejecutar la aplicaciÃ³n.
# AquÃ­ se arranca la aplicaciÃ³n compilada dentro del contenedor.
ENTRYPOINT ["dotnet", "SecureApp.dll"]